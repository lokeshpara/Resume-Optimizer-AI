<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Application Details</title>
    <link rel="stylesheet" href="/application.css" />
</head>

<body>

    <div class="background"></div>

    <div class="container">
        <a href="/dashboard" class="back">Back to Dashboard</a>

        <div class="card">

            <!-- Company & Position -->
            <div class="field">
                <label>Company</label>
                <div class="value-row">
                    <h1 id="companyText"></h1>
                    <button class="edit-btn" onclick="openEditor('company_name')">Edit</button>
                </div>
            </div>

            <div class="field">
                <label>Position Applied</label>
                <div class="value-row">
                    <h2 id="positionText"></h2>
                    <button class="edit-btn" onclick="openEditor('position_applied')">Edit</button>
                </div>
            </div>

            <!-- Meta Info -->
            <div class="meta">
                <div class="meta-item">
                    <label>Status</label>
                    <span id="statusText" class="status"></span>
                    <button class="edit-btn small" onclick="openEditor('status')">Edit</button>
                </div>

                <div class="meta-item">
                    <label>Date Applied</label>
                    <span id="dateText"></span>
                </div>

                <div class="meta-item">
                    <label>Last Updated</label>
                    <span id="updatedText"></span>
                </div>
            </div>

            <!-- Links -->
            <div class="field">
                <label>Resume Link</label>
                <div class="value-row">
                    <a id="resumeLink" target="_blank"></a>
                    <button class="edit-btn" onclick="openEditor('resume_link')">Edit</button>
                </div>
            </div>

            <div class="field">
                <label>Job Posting Link</label>
                <div class="value-row">
                    <a id="jdLink" target="_blank"></a>
                    <button class="edit-btn" onclick="openEditor('jd_link')">Edit</button>
                </div>
            </div>

            <!-- Job Description -->
            <div class="field">
                <label>Job Description</label>
                <p class="hint">Full JD used for resume optimization</p>
                <div class="jd-box">
                    <pre id="jdText"></pre>
                    <button class="edit-btn floating" onclick="openEditor('jd_text')">Edit</button>
                </div>
            </div>

        </div>

        <!-- Notes Section -->
        <div class="card">
            <div class="section-header">
                <h3>Notes</h3>
                <button class="btn-primary small" onclick="openNoteEditor()">Add Note</button>
            </div>
            <div id="notesList" class="notes-list"></div>
        </div>

        <!-- Contacts Section -->
        <div class="card">
            <div class="section-header">
                <h3>Contacts</h3>
                <button class="btn-primary small" onclick="openContactEditor()">Add Contact</button>
            </div>
            <div id="contactsList" class="contacts-list"></div>
        </div>

        <!-- Recruiter Automation Section -->
        <div class="card recruiter-card">
            <div class="section-header">
                <h3>üéØ Auto Get Recruiters</h3>
                <button class="btn-primary" id="autoGetRecruitersBtn" onclick="openRecruiterSettings()">
                    Auto Get Recruiters
                </button>
            </div>
            
            <p class="hint">
                Automatically find top 3 recruiters, get their emails, and create personalized email drafts
            </p>

            <!-- Recruiter Results -->
            <div id="recruiterResults" class="recruiter-results hidden">
                <div class="stats-mini">
                    <span>üîç Searched: <strong id="statSearched">0</strong></span>
                    <span>ü§ñ AI Selected: <strong id="statSelected">0</strong></span>
                    <span>üìß Emails Found: <strong id="statEmails">0</strong></span>
                    <span>‚úÖ Drafts: <strong id="statDrafts">0</strong></span>
                </div>
                
                <div id="recruitersList" class="recruiters-mini-list"></div>
            </div>
        </div>

        <!-- Delete Button -->
        <button id="deleteBtn" class="delete-btn">Delete Application</button>

    </div>

    <!-- Field Editor Popup -->
    <div id="editorOverlay" class="overlay hidden">
        <div class="editor-card">
            <h3 id="editorTitle"></h3>
            <p id="editorHint" class="hint"></p>

            <textarea id="editorInput"></textarea>

            <select id="editorSelect" class="hidden">
                <option>Applied</option>
                <option>Interview</option>
                <option>Offer</option>
                <option>Rejected</option>
            </select>

            <div class="editor-actions">
                <button onclick="closeEditor()">Cancel</button>
                <button class="primary" onclick="saveEditor()">Save</button>
            </div>
        </div>
    </div>

    <!-- Note Editor Popup -->
    <div id="noteOverlay" class="overlay hidden">
        <div class="editor-card">
            <h3>Add Note</h3>
            <p class="hint">Add a note to track important information</p>

            <textarea id="noteInput" placeholder="Enter your note here..."></textarea>

            <div class="editor-actions">
                <button onclick="closeNoteEditor()">Cancel</button>
                <button class="primary" onclick="saveNote()">Save Note</button>
            </div>
        </div>
    </div>

    <!-- Contact Editor Popup -->
    <div id="contactOverlay" class="overlay hidden">
        <div class="editor-card">
            <h3 id="contactEditorTitle">Add Contact</h3>
            <p class="hint">Track recruiters, referrals, and hiring managers</p>

            <input type="hidden" id="contactId" />

            <div class="form-group">
                <label>Full Name *</label>
                <input type="text" id="contactName" placeholder="John Doe" required />
            </div>

            <div class="form-group">
                <label>Email</label>
                <input type="email" id="contactEmail" placeholder="john@company.com" />
            </div>

            <div class="form-group">
                <label>LinkedIn URL</label>
                <input type="url" id="contactLinkedin" placeholder="https://linkedin.com/in/johndoe" />
            </div>

            <div class="form-group">
                <label>Role</label>
                <select id="contactRole">
                    <option value="">Select Role</option>
                    <option value="Recruiter">Recruiter</option>
                    <option value="Hiring Manager">Hiring Manager</option>
                    <option value="Referral">Referral</option>
                    <option value="Team Member">Team Member</option>
                    <option value="Other">Other</option>
                </select>
            </div>

            <div class="form-group">
                <label>Notes</label>
                <textarea id="contactNotes" placeholder="Additional information..."></textarea>
            </div>

            <div class="editor-actions">
                <button onclick="closeContactEditor()">Cancel</button>
                <button class="primary" onclick="saveContact()">Save Contact</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Popup -->
    <div id="deleteOverlay" class="overlay hidden">
        <div class="delete-card">
            <h3>Delete Application</h3>
            <p class="hint">
                This action will permanently delete this application and all associated notes and contacts.
                This cannot be undone.
            </p>

            <div class="delete-actions">
                <button id="cancelDelete">Cancel</button>
                <button id="confirmDelete" class="danger">Delete</button>
            </div>
        </div>
    </div>

    <!-- Recruiter Confirmation Popup -->
<div id="recruiterSettingsOverlay" class="overlay hidden">
    <div class="editor-card">
        <h3>üéØ Auto Find Recruiters</h3>
        <p class="hint">AI will find top 3 recruiters, get their emails, and create personalized Gmail drafts</p>

        <div style="background: #f5f7fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="margin-top: 0; color: #667eea;">üìã What will happen:</h4>
            <ul style="margin: 10px 0; padding-left: 20px; line-height: 1.8;">
                <li>üîç Search Google for recruiters at this company</li>
                <li>ü§ñ AI selects top 3 best matches</li>
                <li>üìß Find their email addresses</li>
                <li>‚úçÔ∏è Generate personalized emails</li>
                <li>üì® Create Gmail drafts (ready to review & send)</li>
            </ul>
            <p style="margin-bottom: 0; color: #666; font-size: 13px;">
                ‚è±Ô∏è This takes about 2-3 minutes
            </p>
        </div>

        <div class="editor-actions">
            <button onclick="closeRecruiterSettings()">Cancel</button>
            <button class="primary" onclick="startRecruiterAutomation()">Start Finding Recruiters</button>
        </div>
    </div>
</div>

    <!-- Recruiter Progress Popup -->
    <div id="recruiterProgressOverlay" class="overlay hidden">
        <div class="progress-card">
            <h3>üîç Finding Recruiters...</h3>
            <div class="progress-steps">
                <div class="progress-step" id="step1">
                    <span class="step-icon">‚è≥</span>
                    <span class="step-text">Extracting job details...</span>
                </div>
                <div class="progress-step" id="step2">
                    <span class="step-icon">‚è≥</span>
                    <span class="step-text">Searching Google for recruiters...</span>
                </div>
                <div class="progress-step" id="step3">
                    <span class="step-icon">‚è≥</span>
                    <span class="step-text">AI selecting top 3 matches...</span>
                </div>
                <div class="progress-step" id="step4">
                    <span class="step-icon">‚è≥</span>
                    <span class="step-text">Finding emails with Hunter.io...</span>
                </div>
                <div class="progress-step" id="step5">
                    <span class="step-icon">‚è≥</span>
                    <span class="step-text">Generating personalized emails...</span>
                </div>
                <div class="progress-step" id="step6">
                    <span class="step-icon">‚è≥</span>
                    <span class="step-text">Creating Gmail drafts...</span>
                </div>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="progressBarFill"></div>
            </div>
        </div>
    </div>

    <script src="/application.js"></script>
</body>

</html>